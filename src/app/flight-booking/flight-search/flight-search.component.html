<h1>Flight Search</h1>

<form #f="ngForm">

  <div class="form-group">
    <label>Von:</label>
    <input class="form-control"
           [(ngModel)]="from"
           required minlength="3" maxlength="30"
           flightCity
           name="from" />

    <div *ngIf="f?.controls['from']?.hasError('flightCity')">
      Dieser Flughafen existiert nicht
    </div>
  </div>

  <!--<div class="form-group">
    <label>Von:</label>
    <input
      name="from"
      [(ngModel)]="from"
      class="form-control"
      required minlength="3" />

    <div *ngIf="!f?.controls['from']?.valid">
      Es liegen Validierungsfehler für diese Eingabe vor.
    </div>
    <div *ngIf="f?.controls['from']?.hasError('required')">
      Dieses Feld ist ein Pflichtfeld.
    </div>
    <div *ngIf="f?.controls['from']?.hasError('minlength')">
      Erfassen Sie bitte min. 3 Zeichen.
    </div>&ndash;&gt;
  </div>
-->

  <div class="form-group">
    <label>To</label>
    <input class="form-control" [(ngModel)]="to" name="to" flightE2eLocator="to">
  </div>

  <div class="form-group">
    <button
      type="button"
      class="btn btn-info"
      (click)="search()"
      [disabled]="!f.valid"
      data-toggle="tooltip" data-placement="left" title="Flüge suchen">
      Suchen
    </button>
  </div>


  <table class="table table-striped">
    <tr *ngFor="let flight of flights"
        [ngClass]="{ 'active':flight === selectedFlight }">
        <td>{{flight.id}}</td>
        <td>{{flight.from}}</td>
        <td>{{flight.to}}</td>
        <td>{{flight.date | date:'dd.MM.yyyy HH:mm'}}</td>
        <td><a (click)="select(flight)">Zeige JSON</a></td>
    </tr>
  </table>

  <div *ngFor="let f of flights" class="col-sx-12 col-sm-6 col-md-4 col-lg-3">
    <flight-card
      [item]="f"
      [selected]="basket[f.id]"
      (selectedChange)="basket[f.id] = $event">

      <a class="btn btn-default"
         [routerLink]="['../flight-edit', f.id]">Editieren</a>
    </flight-card>
  </div>

  <!--<div *ngFor="let f of flights" class="col-sx-12 col-sm-6 col-md-4 col-lg-3">-->
    <!--<flight-card-->
      <!--[item]="f"-->
      <!--[(selected)]="basket[f.id]"-->
    <!--&gt;-->
    <!--</flight-card>-->
  <!--</div>-->

  <!--<div class="form-group">
    <label>Date</label>
    <date-component [(date)]="myDate"></date-component>
  </div>-->

  <pre>JSON-Detail
    -----------------------------
    {{selectedFlight | json}}
  </pre>

  <pre>Warenkorb
    -----------------------------
    {{basket | json}}
  </pre>

</form>
